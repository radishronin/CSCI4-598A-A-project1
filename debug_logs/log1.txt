2025-12-04 21:38:49,399 DEBUG Incoming request POST /rag/api/prompt headers={'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36', 'Content-Type': 'application/json', 'Host': '127.0.0.1:5000'} json={"prompt": "Summarize the differences between the two worlds.", "target_language": "zh", "response_mode": "direct"}
2025-12-04 21:38:49,412 DEBUG /api/prompt called; llm_choice=gemini target_language=zh response_mode=direct
Initializing LLM
Initializing embedding model
Loading llama_index.core.storage.kvstore.simple_kvstore from ./rag_documents/gemini/docstore.json.
Loading llama_index.core.storage.kvstore.simple_kvstore from ./rag_documents/gemini/index_store.json.
Vector index made
Query engine made and monkey-patched with debug wrappers
[RAG RETRIEVE DEBUG] Calling method: retrieve()
[RAG RETRIEVE DEBUG] Result type from retrieve: <class 'list'>
[RAG RETRIEVE DEBUG] retrieve returned 6 nodes:
  1. score=0.41866952240589694 metadata={'file_name': 'Cortazar-LaNocheBocaArriba.pdf', 'file_type': 'application/pdf'} text_snippet=Salió de un brinco a la noche del hospital, al alto cielo raso dulce, a la sombra blanda que lo rodeaba. Pensó que debía haber gritado, pero sus vecinos dormían callados. En la mesa de noche, la botella de agua tenía algo de burbuja, de imagen traslúcida contra la sombra azulada de los ventanales. J
  2. score=0.40421854281894115 metadata={'file_name': 'Cortazar-LaNocheBocaArriba.pdf', 'file_type': 'application/pdf'} text_snippet=Abrió los ojos y era de tarde, con el sol ya bajo en los ventanales de la larga sala. Mientras trataba de sonreír a su vecino, se despegó casi físicamente de la última visión de la pesadilla. El brazo, enyesado, colgaba de un aparato con pesas y poleas. Sintió sed, como si hubiera estado corriendo k
  3. score=0.40296715606659045 metadata={'file_name': 'Cortazar-LaNocheBocaArriba.pdf', 'file_type': 'application/pdf'} text_snippet=--- Page 2 --- camilla de ruedas hasta un pabellón del fondo, pasando bajo árboles llenos de pájaros, cerró los ojos y deseó estar dormido o cloroformado. Pero lo tuvieron largo rato en una pieza con olor a hospital, llenando una ficha, quitándole la ropa y vistiéndolo con una camisa grisácea y dura
  4. score=0.39457624991487705 metadata={'file_name': 'Cortazar-LaNocheBocaArriba.pdf', 'file_type': 'application/pdf'} text_snippet=--- Page 1 --- LA NOCHE BOCA ARRIBA JULIO CORTÁZAR Y salían en ciertas épocas a cazar enemigos; le llamaban la guerra florida. A mitad del largo zaguán del hotel pensó que debía ser tarde, y se apuró a salir a la calle y sacar la motocicleta del rincón donde el portero de al lado le permitía guardar
  5. score=0.39418054521979334 metadata={'file_name': 'Cortazar-LaNocheBocaArriba.pdf', 'file_type': 'application/pdf'} text_snippet=Si conseguía refugiarse en lo profundo de la selva, abandonando la calzada más allá de la región de las ciénagas, quizás los guerreros no le siguieran el rastro. Pensó en los muchos prisioneros que ya habían hecho, pero la cantidad no contaba, sino el tiempo sagrado. La caza continuaría hasta que lo
  6. score=0.39231127990859527 metadata={'file_name': 'Cortazar-LaNocheBocaArriba.pdf', 'file_type': 'application/pdf'} text_snippet=Inútil abrir los ojos y mirar en todas direcciones; lo envolvía una oscuridad absoluta. Quiso enderezarse y sintió las sogas en las muñecas y los tobillos. Estaba estaqueado en el suelo, en un piso de lajas helado y húmedo. El frío le ganaba la espalda desnuda, las piernas. Con el mentón buscó torpe
[RAG RETRIEVE DEBUG] Calling method: query()
[RAG DEBUG] Running query with args= ('Summarize the differences between the two worlds.',) kwargs= {}
[RAG DEBUG] Retrieved 6 nodes:
  1. score=0.41866952240589694 metadata={'file_name': 'Cortazar-LaNocheBocaArriba.pdf', 'file_type': 'application/pdf'} text_snippet=Salió de un brinco a la noche del hospital, al alto cielo raso dulce, a la sombra blanda que lo rodeaba. Pensó que debía haber gritado, pero sus vecinos dormían callados. En la mesa de noche, la botel
  2. score=0.40421854281894115 metadata={'file_name': 'Cortazar-LaNocheBocaArriba.pdf', 'file_type': 'application/pdf'} text_snippet=Abrió los ojos y era de tarde, con el sol ya bajo en los ventanales de la larga sala. Mientras trataba de sonreír a su vecino, se despegó casi físicamente de la última visión de la pesadilla. El brazo
  3. score=0.40296715606659045 metadata={'file_name': 'Cortazar-LaNocheBocaArriba.pdf', 'file_type': 'application/pdf'} text_snippet=--- Page 2 --- camilla de ruedas hasta un pabellón del fondo, pasando bajo árboles llenos de pájaros, cerró los ojos y deseó estar dormido o cloroformado. Pero lo tuvieron largo rato en una pieza con
  4. score=0.39457624991487705 metadata={'file_name': 'Cortazar-LaNocheBocaArriba.pdf', 'file_type': 'application/pdf'} text_snippet=--- Page 1 --- LA NOCHE BOCA ARRIBA JULIO CORTÁZAR Y salían en ciertas épocas a cazar enemigos; le llamaban la guerra florida. A mitad del largo zaguán del hotel pensó que debía ser tarde, y se apuró
  5. score=0.39418054521979334 metadata={'file_name': 'Cortazar-LaNocheBocaArriba.pdf', 'file_type': 'application/pdf'} text_snippet=Si conseguía refugiarse en lo profundo de la selva, abandonando la calzada más allá de la región de las ciénagas, quizás los guerreros no le siguieran el rastro. Pensó en los muchos prisioneros que ya
  6. score=0.39231127990859527 metadata={'file_name': 'Cortazar-LaNocheBocaArriba.pdf', 'file_type': 'application/pdf'} text_snippet=Inútil abrir los ojos y mirar en todas direcciones; lo envolvía una oscuridad absoluta. Quiso enderezarse y sintió las sogas en las muñecas y los tobillos. Estaba estaqueado en el suelo, en un piso de
[RAG RETRIEVE DEBUG] Result type from query: <class 'llama_index.core.base.response.schema.Response'>
[RAG RETRIEVE DEBUG] query returned 6 nodes:
  1. score=0.41866952240589694 metadata={'file_name': 'Cortazar-LaNocheBocaArriba.pdf', 'file_type': 'application/pdf'} text_snippet=Salió de un brinco a la noche del hospital, al alto cielo raso dulce, a la sombra blanda que lo rodeaba. Pensó que debía haber gritado, pero sus vecinos dormían callados. En la mesa de noche, la botella de agua tenía algo de burbuja, de imagen traslúcida contra la sombra azulada de los ventanales. J
  2. score=0.40421854281894115 metadata={'file_name': 'Cortazar-LaNocheBocaArriba.pdf', 'file_type': 'application/pdf'} text_snippet=Abrió los ojos y era de tarde, con el sol ya bajo en los ventanales de la larga sala. Mientras trataba de sonreír a su vecino, se despegó casi físicamente de la última visión de la pesadilla. El brazo, enyesado, colgaba de un aparato con pesas y poleas. Sintió sed, como si hubiera estado corriendo k
  3. score=0.40296715606659045 metadata={'file_name': 'Cortazar-LaNocheBocaArriba.pdf', 'file_type': 'application/pdf'} text_snippet=--- Page 2 --- camilla de ruedas hasta un pabellón del fondo, pasando bajo árboles llenos de pájaros, cerró los ojos y deseó estar dormido o cloroformado. Pero lo tuvieron largo rato en una pieza con olor a hospital, llenando una ficha, quitándole la ropa y vistiéndolo con una camisa grisácea y dura
  4. score=0.39457624991487705 metadata={'file_name': 'Cortazar-LaNocheBocaArriba.pdf', 'file_type': 'application/pdf'} text_snippet=--- Page 1 --- LA NOCHE BOCA ARRIBA JULIO CORTÁZAR Y salían en ciertas épocas a cazar enemigos; le llamaban la guerra florida. A mitad del largo zaguán del hotel pensó que debía ser tarde, y se apuró a salir a la calle y sacar la motocicleta del rincón donde el portero de al lado le permitía guardar
  5. score=0.39418054521979334 metadata={'file_name': 'Cortazar-LaNocheBocaArriba.pdf', 'file_type': 'application/pdf'} text_snippet=Si conseguía refugiarse en lo profundo de la selva, abandonando la calzada más allá de la región de las ciénagas, quizás los guerreros no le siguieran el rastro. Pensó en los muchos prisioneros que ya habían hecho, pero la cantidad no contaba, sino el tiempo sagrado. La caza continuaría hasta que lo
  6. score=0.39231127990859527 metadata={'file_name': 'Cortazar-LaNocheBocaArriba.pdf', 'file_type': 'application/pdf'} text_snippet=Inútil abrir los ojos y mirar en todas direcciones; lo envolvía una oscuridad absoluta. Quiso enderezarse y sintió las sogas en las muñecas y los tobillos. Estaba estaqueado en el suelo, en un piso de lajas helado y húmedo. El frío le ganaba la espalda desnuda, las piernas. Con el mentón buscó torpe
Tool made
[RAG TOOL DEBUG] Failed to wrap tool method run: "LlamaIndexTool" object has no field "run" 
Agent made
2025-12-04 21:38:53,696 DEBUG Agent created for llm_choice=gemini
172.17.0.1 - - [04/Dec/2025 21:38:53] "POST /rag/api/prompt HTTP/1.1" 200 -
[RAG STREAM DEBUG] step keys=['messages'] type=<class 'dict'>
[RAG STREAM DEBUG] step keys=['messages'] type=<class 'dict'>
[RAG DEBUG] Running query with args= ('两个世界之间的差异',) kwargs= {}
[RAG DEBUG] Retrieved 6 nodes:
  1. score=0.472990171347916 metadata={'file_name': 'Cortazar-LaNocheBocaArriba.pdf', 'file_type': 'application/pdf'} text_snippet=Salió de un brinco a la noche del hospital, al alto cielo raso dulce, a la sombra blanda que lo rodeaba. Pensó que debía haber gritado, pero sus vecinos dormían callados. En la mesa de noche, la botel
  2. score=0.4656968767216822 metadata={'file_name': 'Cortazar-LaNocheBocaArriba.pdf', 'file_type': 'application/pdf'} text_snippet=Inútil abrir los ojos y mirar en todas direcciones; lo envolvía una oscuridad absoluta. Quiso enderezarse y sintió las sogas en las muñecas y los tobillos. Estaba estaqueado en el suelo, en un piso de
  3. score=0.46052467739783676 metadata={'file_name': 'Cortazar-LaNocheBocaArriba.pdf', 'file_type': 'application/pdf'} text_snippet=Abrió los ojos y era de tarde, con el sol ya bajo en los ventanales de la larga sala. Mientras trataba de sonreír a su vecino, se despegó casi físicamente de la última visión de la pesadilla. El brazo
  4. score=0.4595440417569985 metadata={'file_name': 'Cortazar-LaNocheBocaArriba.pdf', 'file_type': 'application/pdf'} text_snippet=Si conseguía refugiarse en lo profundo de la selva, abandonando la calzada más allá de la región de las ciénagas, quizás los guerreros no le siguieran el rastro. Pensó en los muchos prisioneros que ya
  5. score=0.45450088365320557 metadata={'file_name': 'Cortazar-LaNocheBocaArriba.pdf', 'file_type': 'application/pdf'} text_snippet=--- Page 2 --- camilla de ruedas hasta un pabellón del fondo, pasando bajo árboles llenos de pájaros, cerró los ojos y deseó estar dormido o cloroformado. Pero lo tuvieron largo rato en una pieza con
  6. score=0.44577651433936155 metadata={'file_name': 'Cortazar-LaNocheBocaArriba.pdf', 'file_type': 'application/pdf'} text_snippet=--- Page 1 --- LA NOCHE BOCA ARRIBA JULIO CORTÁZAR Y salían en ciertas épocas a cazar enemigos; le llamaban la guerra florida. A mitad del largo zaguán del hotel pensó que debía ser tarde, y se apuró
[RAG STREAM DEBUG] step keys=['messages'] type=<class 'dict'>
[RAG STREAM DEBUG] step keys=['messages'] type=<class 'dict'>